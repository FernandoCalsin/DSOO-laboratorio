import java.util.Random;

public class Mapa {
    private String tipoTerritorio;
    private Soldado[][] tablero;
    private Ejercito ejercito1;
    private Ejercito ejercito2;
    private int dimension;

    public Mapa(int dimension) {
        this.dimension = dimension;
        this.tablero = new Soldado[dimension][dimension];
        this.tipoTerritorio = generarTerritorio();
        inicializarEjercitos();
    }

    private String generarTerritorio() {
        String[] tipos = {"bosque", "campo abierto", "monta√±a", "desierto", "playa"};
        return tipos[new Random().nextInt(tipos.length)];
    }

    private void inicializarEjercitos() {
        ejercito1 = new Ejercito("Inglaterra");
        ejercito2 = new Ejercito("Francia");

        ejercito1.generarSoldados(1, dimension);
        ejercito2.generarSoldados(2, dimension);

        colocarEjercitoEnMapa(ejercito1);
        colocarEjercitoEnMapa(ejercito2);
        aplicarBonusTerritorial();
    }

    private void colocarEjercitoEnMapa(Ejercito ejercito) {
        Random rand = new Random();
        for (Soldado s : ejercito.getSoldados()) {
            int fila, columna;
            do {
                fila = rand.nextInt(dimension);
                columna = rand.nextInt(dimension);
            } while (tablero[fila][columna] != null);
            tablero[fila][columna] = s;
        }
    }

    private void aplicarBonusTerritorial() {
        if (tipoTerritorio.equals("bosque")) {
            if (ejercito1.getNombreReino().equals("Inglaterra")) {
                for (Soldado s : ejercito1.getSoldados()) s.setVidaActual(s.getVidaActual() + 1);
            }
        } else if (tipoTerritorio.equals("campo abierto")) {
            if (ejercito2.getNombreReino().equals("Francia")) {
                for (Soldado s : ejercito2.getSoldados()) s.setVidaActual(s.getVidaActual() + 1);
            }
        }
    }

    public void mostrarMapa() {
        System.out.println("=== Territorio: " + tipoTerritorio + " ===");
        for (int i = 0; i < dimension; i++) {
            for (int j = 0; j < dimension; j++) {
                if (tablero[i][j] == null) System.out.print("[ ] ");
                else System.out.print("[" + tablero[i][j].getEjercito() + "] ");
            }
            System.out.println();
        }
    }

    public Ejercito getEjercito1() { return ejercito1; }
    public Ejercito getEjercito2() { return ejercito2; }
}
